<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель управления - Хостинг Портал</title>
    <link rel="stylesheet" href="/static/style/main.css">
    <link rel="stylesheet" href="/static/style/profile.css">
    <link rel="stylesheet" href="/static/style/profile-edit.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="../static/images/icon.png" rel="icon" sizes="any" type="image/x-icon">
</head>
<body>
    <div class="cloud">
        <!-- Верхнее меню -->
        <header class="header">
            <div class="container">
                <div class="logo">
                    <i class="fas fa-server"></i>
                    <a class="flex-none rounded-lg text-xl font-bold outline-none ring-zinc-500 focus-visible:ring dark:ring-zinc-200 dark:focus:outline-none" href="/" aria-label="Brand"> 
                        <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="100px" height="42px" version="1.1" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd" viewBox="0 0 465.16 193.12" class="h-auto w-24" xmlns:xlink="http://www.w3.org/1999/xlink"> <defs> <style type="text/css">
   
    .fil0 {fill:#FBBF24}
    .fil1 {fill:#404040;fill-rule:nonzero}
   
  </style> </defs> <g id="Слой_x0020_2"> <metadata id="CorelCorpID_0Corel-Layer"></metadata> 
    <g id="_2149991450288"> 
        <path class="fil0" d="M300.65 177.75l42.44 -39.68c3.59,-3.35 9.21,-3.16 12.56,0.42l0 0c3.35,3.58 3.16,9.2 -0.42,12.55l-42.44 39.69c-3.59,3.34 -9.21,3.16 -12.56,-0.43l0 0c-3.35,-3.58 -3.16,-9.2 0.42,-12.55z"></path> 
        <path class="fil0" d="M348.71 177.75l42.44 -39.68c3.58,-3.35 9.2,-3.16 12.55,0.42l0.01 0c3.34,3.58 3.16,9.2 -0.43,12.55l-42.44 39.69c-3.58,3.34 -9.2,3.16 -12.55,-0.43l0 0c-3.35,-3.58 -3.17,-9.2 0.42,-12.55z"></path> <path class="fil0" d="M397.04 177.75l47.36 -44.6c3.58,-3.35 9.09,-3.04 12.55,0.42l0.01 0c3.34,3.59 3.14,9.2 -0.43,12.56l-47.36 44.6c-3.58,3.34 -9.21,3.16 -12.56,-0.43l0.01 0c-3.36,-3.58 -3.15,-9.19 0.42,-12.55z"></path> <path class="fil0" d="M445.37 177.75l4.84 -4.53c3.58,-3.35 9.08,-3.04 12.55,0.42l0 0.01c3.35,3.58 3.16,9.2 -0.42,12.55l-4.84 4.53c-3.58,3.34 -9.21,3.16 -12.56,-0.43l0.01 0c-3.36,-3.58 -3.17,-9.2 0.42,-12.55z"></path> 
        <path class="fil0" d="M392.69 22.52c-2.49,-6.78 4.88,-12.94 11.1,-9.29l16.61 9.75c4.59,2.69 5.12,9.12 1.04,12.53l-9.97 8.33c-4.09,3.41 -10.32,1.74 -12.15,-3.25l-6.64 -18.07 0.01 0z"></path> <path class="fil0" d="M355.36 171.08l88.5 -82.38c7.1,-6.71 11.56,-3.69 14.28,-2.49l0 0c3.19,3.74 4.43,9.37 -2.72,16.02l-88.5 82.38c-7.1,6.71 -15.45,9.12 -18.64,5.39l0 0c-3.19,-3.74 -0.07,-12.27 7.08,-18.92z"></path> <path class="fil0" d="M395.14 82.93l42.44 -39.68c3.59,-3.35 9.21,-3.16 12.56,0.42l0 0c3.35,3.58 3.16,9.2 -0.42,12.55l-42.44 39.69c-3.59,3.34 -9.21,3.16 -12.56,-0.43l0 0c-3.35,-3.58 -3.16,-9.2 0.42,-12.55z"></path> <path class="fil0" d="M277.11 132.53c-2.49,-6.77 4.89,-12.93 11.11,-9.28l16.6 9.74c4.59,2.69 5.13,9.12 1.04,12.53l-9.97 8.33c-4.08,3.42 -10.31,1.75 -12.14,-3.25l-6.64 -18.07 0 0z"></path> </g> <path class="fill-current text-neutral-700 dark:text-neutral-300" fill="currentColor" d="M0 191.12l19.38 0 0 -37.25 40.67 0 0 37.25 19.38 0 0 -89.14 -19.38 0 0 33.71 -40.67 0 0 -33.71 -19.38 0 0 89.14zm124.33 -60.08c-17.3,0 -31.37,13.93 -31.37,31.04 0,17.11 14.07,31.04 31.37,31.04 17.29,0 31.36,-13.93 31.36,-31.04 0,-17.11 -14.07,-31.04 -31.36,-31.04zm0 45.46c-7.29,0 -13.14,-6.42 -13.14,-14.42 0,-8 5.85,-14.41 13.14,-14.41 7.28,0 13.13,6.41 13.13,14.41 0,8 -5.85,14.42 -13.13,14.42zm57.66 -9.22c7.86,1.89 15.02,3.09 15.02,6.1 0,2.48 -4.12,3.5 -8.37,3.5 -8.37,0 -17.17,-3.71 -17.17,-3.71l-7.37 13.13c0,0 12.02,6.82 25.26,6.82 15.86,0 25.89,-9.53 25.89,-19.74 0,-8.21 -6.49,-15.3 -20.34,-18.1 -8.29,-1.7 -10.39,-3.09 -10.39,-4.9 0,-2.59 4.44,-3.09 7.46,-3.09 4.63,0 9.28,1.3 13.04,2.69l7.78 -13.72c0,0 -10.3,-5.22 -21.52,-5.22 -14.16,0 -24.06,7.32 -24.87,18.06 -0.48,6.98 2.85,15.08 15.58,18.18zm52.95 -49.27l0 15.05 -9.71 0 0 16.63 9.71 0 0 41.43 18.23 0 0 -41.43 11.11 0 0 -16.63 -11.11 0 0 -25.15 -18.23 10.1z"></path> <path class="fill-current text-neutral-700 dark:text-neutral-300" fill="currentColor" d="M79.26 3.03l0 89.15 37.92 0c24.65,0 44.54,-19.89 44.54,-44.57 0,-24.69 -19.89,-44.58 -44.54,-44.58l-37.92 0zm19.19 70.97l0 -52.79 18.73 0c14.02,0 25.34,11.83 25.34,26.4 0,14.56 -11.32,26.39 -25.34,26.39l-18.73 0zm97.42 -41.91c-17.13,0 -31.06,13.94 -31.06,31.05 0,17.11 13.93,31.04 31.06,31.04 17.14,0 31.07,-13.93 31.07,-31.04 0,-17.11 -13.93,-31.05 -31.07,-31.05zm0 45.47c-7.21,0 -13,-6.42 -13,-14.42 0,-8 5.79,-14.42 13,-14.42 7.22,0 13.01,6.42 13.01,14.42 0,8 -5.79,14.42 -13.01,14.42zm38.62 14.62l18.06 0 0 -29.57 24.75 29.57 22.65 0 -26.86 -30.85 25.45 -27.26 -22.35 0 -23.64 26.25 0 -60.32 -18.06 0 0 92.18zm111.74 -58.13l0 34.98 -14.73 7.51c-5.31,-0.21 -8.51,-3.11 -8.51,-12.83l0 -29.66 -18.06 0 0 35.57c0,17.64 11.75,24.56 25.47,24.56l1.6 0 14.23 -7.62 0.61 5.62 17.45 0 0 -58.13 -18.06 0z"></path> </g> </svg> </a>
                </div>
                
                <!-- Бургер меню для мобильных -->
                <button class="burger-menu" id="burgerMenu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <!--<div class="containerNav">
                    {% if user_authenticated %}
                    Баланс и кнопка пополнить в одной строке -->
                        <!--<div class="balance-item">
                            <span class="balance-amount">
                                <i class="fas fa-wallet"></i>
                                Баланс: 0 руб.
                            </span>
                            <button class="btn-topup" data-action="topup">
                                <i class="fas fa-plus"></i>
                                Пополнить
                            </button>
                        </div>
                    {% endif %}
                </div>-->
                <nav class="nav" id="mainNav">
                    {% if user_authenticated %}
                    <div class="user-info">
                        <!-- Поддержка с иконкой конверта -->
                        <div class="support-item">
                            <a href="/ticket" class="support-link">
                                <i class="fas fa-envelope"></i>
                                Поддержка
                                {% if false %}
                                <span class="notification-dot"></span>
                                {% endif %}
                            </a>
                        </div>

                        <!-- Баланс и кнопка пополнить в одной строке -->
                        <div class="balance-item">
                            <span class="balance-amount">
                                <i class="fas fa-wallet"></i>
                                Баланс: 0 руб.
                            </span>
                            <button class="btn-topup" data-action="topup">
                                <i class="fas fa-plus"></i>
                                Пополнить
                            </button>
                        </div>

                        <!-- UserID с выпадающим меню -->
                        <div class="user-dropdown">
                            <button class="user-toggle">
                                <i class="fas fa-user-circle"></i>
                                ID: {{ current_user.id }}
                                <!-- Вернуться сюда!{{ current_user.user_nick }} -->
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="dropdown-menu">
                                <a href="#" class="dropdown-item" data-content="profile">
                                    <i class="fas fa-user"></i>
                                    Профиль
                                </a>
                                <a href="#" class="dropdown-item" data-action="logout">
                                    <i class="fas fa-sign-out-alt"></i>
                                    Выйти
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </nav>
            </div>
        </header>
        <!-- Основной контент с центрированием -->
        <div class="main-container-wrapper">
            <div class="main-container">
                <!-- Левое меню -->
                <aside class="sidebar" id="sidebar">
                    <!-- Мобильное верхнее меню в сайдбаре -->
                    <div class="mobile-user-card" id="mobileUserCard">
                        <div class="mobile-user-info">
                            <div class="mobile-user-avatar">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div class="mobile-user-details">
                                <div class="mobile-user-name">ID: {{ current_user.id }}</div>
                                <div class="mobile-user-balance">
                                    <i class="fas fa-wallet"></i>
                                    Баланс: 0 руб.
                                </div>
                            </div>
                        </div>
                        <div class="mobile-user-actions">
                            <button class="btn-mobile-topup" data-action="topup">
                                <i class="fas fa-plus"></i>
                                Пополнить
                            </button>
                            <button class="btn-mobile-support" data-action="support">
                                <i class="fas fa-envelope"></i>
                                Поддержка
                            </button>
                        </div>
                        <!-- Мобильное меню пользователя -->
                        <div class="mobile-user-menu">
                            <a href="#" class="mobile-menu-item" data-content="profile">
                                <i class="fas fa-user"></i>
                                Профиль
                            </a>
                            <a href="#" class="mobile-menu-item" data-action="logout">
                                <i class="fas fa-sign-out-alt"></i>
                                Выйти
                            </a>
                        </div>
                    </div>

                    <nav class="sidebar-nav">
                        <!-- Проекты -->
                        <div class="nav-section">
                            <h3 class="nav-section-title">
                                <i class="fas fa-folder"></i>
                                Проекты
                            </h3>
                            <ul class="nav-list">
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="projects">
                                        <i class="fas nav-icon fa-list"></i>
                                        <span class="nav-text">Мои проекты</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="#" class="nav-link create-new" data-action="create-project">
                                        <i class="fas nav-icon fa-plus-circle"></i>
                                        <span class="nav-text">Создать проект</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <!-- Сервисы -->
                        <div class="nav-section">
                            <h3 class="nav-section-title">
                                <i class="fas fa-cube"></i>
                                Сервисы
                            </h3>
                            <ul class="nav-list">
                                <li class="nav-item">
                                    <a href="#" class="nav-link active" data-content="dashboard">
                                        <i class="fas nav-icon fa-tachometer-alt"></i>
                                        <span class="nav-text">Обзор сервисов</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="all-services">
                                        <i class="fas fa-server"></i>
                                        <span class="nav-text">Все сервисы</span>
                                        <span class="badge">{{ total_services }}</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="vps-services">
                                        <i class="fas fa-cloud"></i>
                                        <span class="nav-text">VPS</span>
                                        <span class="badge">{{ service_stats.by_type.get('vps', 0) }}</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="docker-services">
                                        <i class="fas fa-box"></i>
                                        <span class="nav-text">Docker</span>
                                        <span class="badge">{{ service_stats.by_type.get('docker', 0) }}</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="n8n-services">
                                        <i class="fas fa-project-diagram"></i>
                                        <span class="nav-text">n8n</span>
                                        <span class="badge">{{ service_stats.by_type.get('n8n', 0) }}</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <!-- Техподдержка -->
                        <div class="nav-section">
                            <h3 class="nav-section-title">
                                <i class="fas fa-headset"></i>
                                Поддержка
                            </h3>
                            <ul class="nav-list">
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="user-tickets">
                                        <i class="fas fa-ticket-alt"></i>
                                        <span class="nav-text">Мои обращения</span>
                                        <span class="badge" id="tickets-count">0</span>
                                    </a>
                                </li>
                                {% if current_user.role_id in [1, 2, 3] %}
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="admin-tickets">
                                        <i class="fas fa-cog"></i>
                                        <span class="nav-text">Управление обращениями</span>
                                    </a>
                                </li>
                                {% endif %}
                            </ul>
                        </div>

                        <!-- Финансы -->
                        <div class="nav-section">
                            <h3 class="nav-section-title">
                                <i class="fas fa-credit-card"></i>
                                Финансы
                            </h3>
                            <ul class="nav-list">
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="invoices">
                                        <i class="fas fa-file-invoice"></i>
                                        <span class="nav-text">Счета и платежи</span>
                                        {% if pending_invoices_count > 0 %}
                                        <span class="badge badge-warning">{{ pending_invoices_count }}</span>
                                        {% endif %}
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="#" class="nav-link" data-content="billing-history">
                                        <i class="fas fa-history"></i>
                                        <span class="nav-text">История операций</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <!-- Документация -->
                        <div class="nav-section">
                            <h3 class="nav-section-title">
                                <i class="fas fa-book"></i>
                                Документация
                            </h3>
                            <ul class="nav-list">
                                <li class="nav-item">
                                    <a href="https://wiki.dokuhost.ru" target="_blank" class="nav-link">
                                        <i class="fas fa-external-link-alt"></i>
                                        <span class="nav-text">База знаний</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </aside>

                <!-- Основное содержимое -->
                <main class="main-content">
                    <div class="content-header">
                        <h1 id="contentTitle">Панель управления</h1>
                        <div class="breadcrumb" id="breadcrumb">
                            <span>Главная</span> / <span class="active">Панель управления</span>
                        </div>
                    </div>

                    <!-- Динамический контент -->
                    <div id="dynamic-content">
                        <!-- Стартовая страница с дашбордом -->
                        <div class="dashboard-content active" id="dashboard-content">
                            <!-- Статистика -->
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-server"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3>{{ total_services }}</h3>
                                        <p>Всего сервисов</p>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3>{{ service_stats.by_status.get('stopped', 0) }}</h3>
                                        <p>Остановлено</p>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon danger">
                                        <i class="fas fa-file-invoice-dollar"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3>{{ pending_invoices_count }}</h3>
                                        <p>Ожидают оплаты</p>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon success">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3>{{ service_stats.by_status.get('running', 0) }}</h3>
                                        <p>Активных</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Быстрые действия -->
                            <div class="quick-actions">
                                <h2>Быстрые действия</h2>
                                <div class="actions-grid">
                                    <button class="action-btn" data-action="create-vps">
                                        <i class="fas fa-cloud"></i>
                                        Создать VPS
                                    </button>
                                    <button class="action-btn" data-action="create-docker">
                                        <i class="fas fa-box"></i>
                                        Запустить Docker
                                    </button>
                                    <button class="action-btn" data-action="create-n8n">
                                        <i class="fas fa-project-diagram"></i>
                                        Установить n8n
                                    </button>
                                    <button class="action-btn" data-action="topup">
                                        <i class="fas fa-plus"></i>
                                        Пополнить баланс
                                    </button>
                                </div>
                            </div>

                            <!-- Последние сервисы -->
                            {% if services %}
                            <div class="recent-services">
                                <h2>Последние сервисы</h2>
                                <div class="services-list">
                                    {% for service in services[:5] %}
                                    <div class="service-item">
                                        <div class="service-icon">
                                            <i class="fas fa-{{ 'cloud' if service.service_type == 'vps' else 'box' if service.service_type == 'docker' else 'project-diagram' }}"></i>
                                        </div>
                                        <div class="service-info">
                                            <h4>{{ service.name }}</h4>
                                            <span class="service-type">{{ service.service_type }}</span>
                                            <span class="service-status {{ service.status }}">{{ service.status }}</span>
                                        </div>
                                        <div class="service-actions">
                                            <button class="btn-small" data-action="start-service" data-service-id="{{ service.id }}">Запуск</button>
                                            <button class="btn-small" data-action="stop-service" data-service-id="{{ service.id }}">Стоп</button>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        </div>

                        <!-- Контейнер для динамически загружаемых модулей -->
                        <div id="modules-container"></div>
                    </div>
                </main>
            </div>
        </div>
    </div>
    <script src="/static/js/profile-edit.js"></script>
    <script src="/static/js/script.js"></script>
    
</body>
</html>